<!-- rsa_tool/views/pages/index.html -->
{% extends "layouts/base.html" %}

{% block content %}
<!-- Key Generation Section -->
<section id="keygen" class="page-section active">
    <div class="card">
        <h2>üîë Generate RSA Key Pair</h2>
        
        <div class="info-box">
            <strong>Thu·∫≠t to√°n:</strong> CLRS 31.7 - RSA Key Generation<br>
            S·ª≠ d·ª•ng Miller-Rabin (CLRS 31.8) ƒë·ªÉ sinh s·ªë nguy√™n t·ªë
        </div>
        
        <form id="keygenForm" class="form">
            <div class="form-group">
                <label for="keyBits">Key Size (bits):</label>
                <select id="keyBits" name="bits" class="form-select">
                    <option value="512">512 bits (Demo only - Fast)</option>
                    <option value="1024" selected>1024 bits (Recommended)</option>
                    <option value="2048">2048 bits (Secure - Slow)</option>
                </select>
            </div>
            
            <button type="submit" class="btn btn-primary">
                <span class="btn-text">Generate Keys</span>
                <span class="btn-loading" style="display:none;">
                    <span class="spinner"></span> Generating...
                </span>
            </button>
        </form>
        
        <div id="keygenOutput" class="output-container" style="display:none;"></div>
    </div>
</section>

<!-- Encryption Section -->
<section id="encrypt" class="page-section">
    <div class="card">
        <h2>üîí Encrypt Message</h2>
        
        <div class="info-box">
            <strong>C√¥ng th·ª©c:</strong> c = m<sup>e</sup> mod n<br>
            Ch·ªâ c·∫ßn public key (e, n) ƒë·ªÉ m√£ h√≥a
        </div>
        
        <form id="encryptForm" class="form">
            <div class="form-group">
                <label for="encryptMessage">Message to Encrypt:</label>
                <textarea id="encryptMessage" name="message" class="form-textarea" rows="3" 
                          placeholder="Enter your message here...">Hello RSA!</textarea>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="encryptE">Public Exponent (e):</label>
                    <input type="text" id="encryptE" name="e" class="form-input" 
                           placeholder="65537">
                </div>
                
                <div class="form-group">
                    <label for="encryptN">Modulus (n):</label>
                    <textarea id="encryptN" name="n" class="form-textarea" rows="2" 
                              placeholder="Enter public modulus n"></textarea>
                </div>
            </div>
            
            <button type="submit" class="btn btn-primary">
                <span class="btn-text">Encrypt</span>
                <span class="btn-loading" style="display:none;">
                    <span class="spinner"></span> Encrypting...
                </span>
            </button>
        </form>
        
        <div id="encryptOutput" class="output-container" style="display:none;"></div>
    </div>
</section>

<!-- Decryption Section -->
<section id="decrypt" class="page-section">
    <div class="card">
        <h2>üîì Decrypt Message</h2>
        
        <div class="info-box">
            <strong>C√¥ng th·ª©c:</strong> m = c<sup>d</sup> mod n<br>
            C·∫ßn private key (d, n) ƒë·ªÉ gi·∫£i m√£
        </div>
        
        <form id="decryptForm" class="form">
            <div class="form-group">
                <label for="decryptCiphertext">Ciphertext (comma-separated blocks):</label>
                <textarea id="decryptCiphertext" name="ciphertext" class="form-textarea" rows="3" 
                          placeholder="123456789, 987654321, ..."></textarea>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="decryptD">Private Exponent (d):</label>
                    <textarea id="decryptD" name="d" class="form-textarea" rows="2" 
                              placeholder="Enter private exponent d"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="decryptN">Modulus (n):</label>
                    <textarea id="decryptN" name="n" class="form-textarea" rows="2" 
                              placeholder="Enter modulus n"></textarea>
                </div>
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="useCRT" name="use_crt">
                    <span>Use CRT optimization (requires p and q)</span>
                </label>
            </div>
            
            <button type="submit" class="btn btn-primary">
                <span class="btn-text">Decrypt</span>
                <span class="btn-loading" style="display:none;">
                    <span class="spinner"></span> Decrypting...
                </span>
            </button>
        </form>
        
        <div id="decryptOutput" class="output-container" style="display:none;"></div>
    </div>
</section>

<!-- Sign Section -->
<section id="sign" class="page-section">
    <div class="card">
        <h2>‚úçÔ∏è Sign Message</h2>
        
        <div class="info-box">
            <strong>C√¥ng th·ª©c:</strong> sig = hash(m)<sup>d</sup> mod n<br>
            D√πng SHA-256 hash, sau ƒë√≥ k√Ω v·ªõi private key
        </div>
        
        <form id="signForm" class="form">
            <div class="form-group">
                <label for="signMessage">Message to Sign:</label>
                <textarea id="signMessage" name="message" class="form-textarea" rows="3" 
                          placeholder="Enter your message...">I owe Alice $100</textarea>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="signD">Private Exponent (d):</label>
                    <textarea id="signD" name="d" class="form-textarea" rows="2" 
                              placeholder="Enter private exponent d"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="signN">Modulus (n):</label>
                    <textarea id="signN" name="n" class="form-textarea" rows="2" 
                              placeholder="Enter modulus n"></textarea>
                </div>
            </div>
            
            <button type="submit" class="btn btn-primary">
                <span class="btn-text">Sign</span>
                <span class="btn-loading" style="display:none;">
                    <span class="spinner"></span> Signing...
                </span>
            </button>
        </form>
        
        <div id="signOutput" class="output-container" style="display:none;"></div>
    </div>
</section>

<!-- Verify Section -->
<section id="verify" class="page-section">
    <div class="card">
        <h2>‚úÖ Verify Signature</h2>
        
        <div class="info-box">
            <strong>C√¥ng th·ª©c:</strong> sig<sup>e</sup> mod n = hash(m)<br>
            Ch·ªâ c·∫ßn public key (e, n) ƒë·ªÉ x√°c minh
        </div>
        
        <form id="verifyForm" class="form">
            <div class="form-group">
                <label for="verifyMessage">Original Message:</label>
                <textarea id="verifyMessage" name="message" class="form-textarea" rows="3" 
                          placeholder="Enter the original message..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="verifySignature">Signature:</label>
                <input type="text" id="verifySignature" name="signature" class="form-input" 
                       placeholder="Enter signature">
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="verifyE">Public Exponent (e):</label>
                    <input type="text" id="verifyE" name="e" class="form-input" 
                           placeholder="65537">
                </div>
                
                <div class="form-group">
                    <label for="verifyN">Modulus (n):</label>
                    <textarea id="verifyN" name="n" class="form-textarea" rows="2" 
                              placeholder="Enter public modulus n"></textarea>
                </div>
            </div>
            
            <button type="submit" class="btn btn-primary">
                <span class="btn-text">Verify</span>
                <span class="btn-loading" style="display:none;">
                    <span class="spinner"></span> Verifying...
                </span>
            </button>
        </form>
        
        <div id="verifyOutput" class="output-container" style="display:none;"></div>
    </div>
</section>

<!-- Demos Section -->
<section id="demos" class="page-section">
    <div class="card">
        <h2>üé¨ Interactive Demos</h2>
        
        <div class="info-box">
            <strong>C√°c demo minh h·ªça t·ª´ CLRS Ch∆∞∆°ng 31</strong><br>
            Nh·∫•n v√†o c√°c n√∫t b√™n d∆∞·ªõi ƒë·ªÉ ch·∫°y demo t∆∞∆°ng ·ª©ng
        </div>
        
        <div class="demo-grid">
            <button class="demo-card" data-demo="basic_rsa">
                <div class="demo-icon">üìù</div>
                <div class="demo-title">Demo 01: Basic RSA</div>
                <div class="demo-desc">M√£ h√≥a, gi·∫£i m√£ v√† ch·ªØ k√Ω s·ªë c∆° b·∫£n</div>
            </button>
            
            <button class="demo-card" data-demo="miller_rabin">
                <div class="demo-icon">üî¢</div>
                <div class="demo-title">Demo 02: Miller-Rabin</div>
                <div class="demo-desc">Ki·ªÉm tra s·ªë nguy√™n t·ªë v√† sinh s·ªë nguy√™n t·ªë</div>
            </button>
            
            <button class="demo-card" data-demo="crt_speed">
                <div class="demo-icon">‚ö°</div>
                <div class="demo-title">Demo 03: CRT Speed</div>
                <div class="demo-desc">T·ªëi ∆∞u h√≥a b·∫±ng Chinese Remainder Theorem</div>
            </button>
            
            <button class="demo-card" data-demo="pollard_rho">
                <div class="demo-icon">üí•</div>
                <div class="demo-title">Demo 04: Pollard Rho</div>
                <div class="demo-desc">Ph√° RSA y·∫øu b·∫±ng ph√¢n t√≠ch th·ª´a s·ªë</div>
            </button>
            
            <button class="demo-card" data-demo="textbook_padding">
                <div class="demo-icon">‚ö†Ô∏è</div>
                <div class="demo-title">Demo 05: Textbook Padding</div>
                <div class="demo-desc">L·ªó h·ªïng c·ªßa RSA kh√¥ng c√≥ padding</div>
            </button>
        </div>
        
        <div id="demoOutput" class="output-terminal" style="display:none;"></div>
    </div>
</section>
{% endblock %}